<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.com.start.webBack.mapper.ChargeReportsMapper">
	<!-- 按年统计查询记录 -->
	<select id="selectStatisticsByYear" parameterType="FindreportsDto" resultType="reportsDtoNew">
			SELECT
				A.YMD STATISTICSTIME,
				IFNULL(A.COUNT,0) CHARGECOUNT,
				ROUND(IFNULL(A.CHARGEQUANTITYSUM,0),2) CHARGEQUANTITY,
				ROUND(IFNULL(A.CHARGEMONEYSUM,0),2) CHARGEMONEY,
				ROUND(IFNULL(B.APPEXPENSESUM,0),2) APPCHARGEMONEY,
			    ROUND(IFNULL(C.CARDEXPENSESUM,0),2) CARDCHARGEMONEY,
				ROUND(IFNULL(D.WCEXPENSESUM,0),2)WCCHARGEMONEY,
				ROUND(IFNULL(A.SERVICETIPSUM,0),2) SERVICETIP,
				ROUND(IFNULL(A.EXPENSESUM,0),2) SUMCHARGEMONEY,
				ROUND(IFNULL(A.JQSUM,0),2) JQ,
				ROUND(IFNULL(A.JFSUM,0),2) JF,
				ROUND(IFNULL(A.FQSUM,0),2) FQ,
				ROUND(IFNULL(A.FFSUM,0),2) FF,
				ROUND(IFNULL(A.PQSUM,0),2) PQ,
				ROUND(IFNULL(A.PFSUM,0),2) PF,
				ROUND(IFNULL(A.GQSUM,0),2) GQ,
				ROUND(IFNULL(A.GFSUM,0),2) GF
			FROM
				(SELECT 
					DATE_FORMAT(RECORDTIME,'%Y') YMD,
					COUNT(*) COUNT,
					SUM(CHARGEQUANTITY) CHARGEQUANTITYSUM,
					SUM(CHARGEMONEY) CHARGEMONEYSUM,
					SUM(SERVICETIP) SERVICETIPSUM,
					SUM(CHARGEMONEY)+SUM(SERVICETIP) EXPENSESUM,
					SUM(JQ) JQSUM,
					SUM(JF) JFSUM,
					SUM(FQ) FQSUM,
					SUM(FF) FFSUM,
					SUM(PQ) PQSUM,
					SUM(PF) PFSUM,
					SUM(GQ) GQSUM,
					SUM(GF) GFSUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE   
						UCR.CPID = CP.CPID
				AND     CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )A
				LEFT JOIN(
				SELECT  DATE_FORMAT(RECORDTIME,'%Y') YMD ,
						SUM(CHARGEMONEY)+SUM(SERVICETIP) APPEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						CHARGEMETHODID=0
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )B
				ON A.YMD = B.YMD
				LEFT JOIN(
				SELECT  DATE_FORMAT(RECORDTIME,'%Y') YMD ,
						SUM(CHARGEMONEY)+SUM(SERVICETIP) CARDEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP 
				WHERE 
						CHARGEMETHODID=1
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD )C
				ON A.YMD = C.YMD
				LEFT JOIN(
				SELECT  DATE_FORMAT(RECORDTIME,'%Y') YMD ,
						SUM(CHARGEMONEY)+SUM(SERVICETIP) WCEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE CHARGEMETHODID=3
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )D
				ON A.YMD =D.YMD
			ORDER BY A.YMD DESC
	</select>
	
	<!-- 按月统计查询记录 -->
	<select id="selectStatisticsByMonth" parameterType="FindreportsDto" resultType="reportsDtoNew">
			SELECT
					A.YMD STATISTICSTIME,
					IFNULL(A.COUNT,0) CHARGECOUNT,
					ROUND(IFNULL(A.CHARGEQUANTITYSUM,0),2) CHARGEQUANTITY,
					ROUND(IFNULL(A.CHARGEMONEYSUM,0),2) CHARGEMONEY,
					ROUND(IFNULL(B.APPEXPENSESUM,0),2) APPCHARGEMONEY,
				    ROUND(IFNULL(C.CARDEXPENSESUM,0),2) CARDCHARGEMONEY,
					ROUND(IFNULL(D.WCEXPENSESUM,0),2)WCCHARGEMONEY,
					ROUND(IFNULL(A.SERVICETIPSUM,0),2) SERVICETIP,
					ROUND(IFNULL(A.EXPENSESUM,0),2) SUMCHARGEMONEY,
					ROUND(IFNULL(A.JQSUM,0),2) JQ,
					ROUND(IFNULL(A.JFSUM,0),2) JF,
					ROUND(IFNULL(A.FQSUM,0),2) FQ,
					ROUND(IFNULL(A.FFSUM,0),2) FF,
					ROUND(IFNULL(A.PQSUM,0),2) PQ,
					ROUND(IFNULL(A.PFSUM,0),2) PF,
					ROUND(IFNULL(A.GQSUM,0),2) GQ,
					ROUND(IFNULL(A.GFSUM,0),2) GF
			FROM
				(SELECT 
					DATE_FORMAT(RECORDTIME,'%Y/%m') YMD ,
					COUNT(*) COUNT,
					SUM(CHARGEQUANTITY) CHARGEQUANTITYSUM,
					SUM(CHARGEMONEY) CHARGEMONEYSUM,
					SUM(SERVICETIP) SERVICETIPSUM,
					SUM(CHARGEMONEY)+SUM(SERVICETIP) EXPENSESUM,
					SUM(JQ) JQSUM,
					SUM(JF) JFSUM,
					SUM(FQ) FQSUM,
					SUM(FF) FFSUM,
					SUM(PQ) PQSUM,
					SUM(PF) PFSUM,
					SUM(GQ) GQSUM,
					SUM(GF) GFSUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE} 
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )A
				LEFT JOIN(
				SELECT DATE_FORMAT(RECORDTIME,'%Y/%m') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) APPEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						CHARGEMETHODID=0
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE} 
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )B
				ON A.YMD = B.YMD
				LEFT JOIN(
				SELECT DATE_FORMAT(RECORDTIME,'%Y/%m') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) CARDEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						CHARGEMETHODID=1
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE} 
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD )C
				ON A.YMD = C.YMD
				LEFT JOIN(
				SELECT DATE_FORMAT(RECORDTIME,'%Y/%m') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) WCEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						CHARGEMETHODID=3
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE} 
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )D
				ON A.YMD =D.YMD 
		ORDER BY A.YMD DESC
	</select>
	
	<!-- 按日统计查询记录 -->
	<select id="selectStatisticsByDay" parameterType="FindreportsDto" resultType="reportsDtoNew">
		SELECT
				A.YMD STATISTICSTIME,
				IFNULL(A.COUNT,0) CHARGECOUNT,
				ROUND(IFNULL(A.CHARGEQUANTITYSUM,0),2) CHARGEQUANTITY,
				ROUND(IFNULL(A.CHARGEMONEYSUM,0),2) CHARGEMONEY,
				ROUND(IFNULL(B.APPEXPENSESUM,0),2) APPCHARGEMONEY,
			    ROUND(IFNULL(C.CARDEXPENSESUM,0),2) CARDCHARGEMONEY,
				ROUND(IFNULL(D.WCEXPENSESUM,0),2)WCCHARGEMONEY,
				ROUND(IFNULL(A.SERVICETIPSUM,0),2) SERVICETIP,
				ROUND(IFNULL(A.EXPENSESUM,0),2) SUMCHARGEMONEY,
				ROUND(IFNULL(A.JQSUM,0),2) JQ,
				IFNULL(A.JFSUM,0) JF,
				ROUND(IFNULL(A.FQSUM,0),2) FQ,
				ROUND(IFNULL(A.FFSUM,0),2) FF,
				ROUND(IFNULL(A.PQSUM,0),2) PQ,
				ROUND(IFNULL(A.PFSUM,0),2) PF,
				ROUND(IFNULL(A.GQSUM,0),2) GQ,
				ROUND(IFNULL(A.GFSUM,0),2) GF
		FROM
			(SELECT 
				DATE_FORMAT(RECORDTIME,'%Y/%m/%d') YMD ,
				COUNT(*) COUNT,
				SUM(CHARGEQUANTITY) CHARGEQUANTITYSUM,
				SUM(CHARGEMONEY) CHARGEMONEYSUM,
				SUM(SERVICETIP) SERVICETIPSUM,
				SUM(CHARGEMONEY)+SUM(SERVICETIP) EXPENSESUM,
				SUM(JQ) JQSUM,
				SUM(JF) JFSUM,
				SUM(FQ) FQSUM,
				SUM(FF) FFSUM,
				SUM(PQ) PQSUM,
				SUM(PF) PFSUM,
				SUM(GQ) GQSUM,
				SUM(GF) GFSUM
			FROM USERCHARGERECORD UCR,CPINFO CP
			WHERE UCR.CPID = CP.CPID
			AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY YMD  )A
			LEFT JOIN(
			SELECT DATE_FORMAT(RECORDTIME,'%Y/%m/%d') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) APPEXPENSESUM
			FROM USERCHARGERECORD UCR,CPINFO CP
			WHERE 
					CHARGEMETHODID=0
			AND 
					UCR.CPID = CP.CPID
			AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY YMD  )B
			ON A.YMD = B.YMD
			LEFT JOIN(
			SELECT DATE_FORMAT(RECORDTIME,'%Y/%m/%d') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) CARDEXPENSESUM
			FROM USERCHARGERECORD UCR,CPINFO CP
			WHERE CHARGEMETHODID=1
			AND 
					UCR.CPID = CP.CPID
			AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY YMD )C
			ON A.YMD = C.YMD
			LEFT JOIN(
			SELECT DATE_FORMAT(RECORDTIME,'%Y/%m/%d') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) WCEXPENSESUM
			FROM USERCHARGERECORD UCR,CPINFO CP
			WHERE 
					CHARGEMETHODID=3
			AND 
					UCR.CPID = CP.CPID
			AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY YMD  )D
			ON A.YMD =D.YMD
		ORDER BY A.YMD DESC
	</select>
	
	<!-- 合计 -->
	<select id="selectTotal" parameterType="FindreportsDto" resultType="TotalDto">
		SELECT  IFNULL(SUM(E.CHARGECOUNT),0) TOTALCOUNT,
				ROUND(IFNULL(SUM(E.CHARGEQUANTITY),0),2) TOTALQUANTITY,
				ROUND(IFNULL(SUM(E.CHARGEMONEY),0),2) TOTALCHARGEMONEY,
				ROUND(IFNULL(SUM(E.APPCHARGEMONEY),0),2) TOTALAPPCHARGEMONEY,
				ROUND(IFNULL(SUM(E.CARDCHARGEMONEY),0),2) TOTALCARDCHARGEMONEY,
				ROUND(IFNULL(SUM(E.WCCHARGEMONEY),0),2) TOTALWCCHARGEMONEY,
				ROUND(IFNULL(SUM(E.SERVICETIP),0),2) TOTALSERVICETIP,
				ROUND(IFNULL(SUM(E.SUMCHARGEMONEY),0),2) TOTALSUMCHARGEMONEY,
				ROUND(IFNULL(SUM(E.JQ),0),2) TOTALJQ,
				ROUND(IFNULL(SUM(E.JF),0),2) TOTALJF,
				ROUND(IFNULL(SUM(E.FQ),0),2) TOTALFQ,
				ROUND(IFNULL(SUM(E.FF),0),2) TOTALFF,
				ROUND(IFNULL(SUM(E.PQ),0),2) TOTALPQ,
			    ROUND(IFNULL(SUM(E.PF),0),2) TOTALPF,
				ROUND(IFNULL(SUM(E.GQ),0),2) TOTALGQ,
				ROUND(IFNULL(SUM(E.GF),0),2) TOTALGF
			FROM(
			SELECT
				A.YMD STATISTICSTIME,
				IFNULL(A.COUNT,0) CHARGECOUNT,
				IFNULL(A.CHARGEQUANTITYSUM,0) CHARGEQUANTITY,
				IFNULL(A.CHARGEMONEYSUM,0) CHARGEMONEY,
				IFNULL(B.APPEXPENSESUM ,0) APPCHARGEMONEY,
				IFNULL(C.CARDEXPENSESUM ,0) CARDCHARGEMONEY,
				IFNULL(D.WCEXPENSESUM ,0)WCCHARGEMONEY,
				IFNULL(A.SERVICETIPSUM,0) SERVICETIP,
				IFNULL(A.EXPENSESUM,0) SUMCHARGEMONEY,
				IFNULL(A.JQSUM,0) JQ,
				IFNULL(A.JFSUM,0) JF,
				IFNULL(A.FQSUM,0) FQ,
				IFNULL(A.FFSUM,0) FF,
				IFNULL(A.PQSUM,0) PQ,
				IFNULL(A.PFSUM,0) PF,
				IFNULL(A.GQSUM,0) GQ,
				IFNULL(A.GFSUM,0) GF
			FROM
				(SELECT 
					DATE_FORMAT(RECORDTIME,'%Y/%M/%D') YMD ,
					COUNT(*) COUNT,
					SUM(CHARGEQUANTITY) CHARGEQUANTITYSUM,
					SUM(CHARGEMONEY) CHARGEMONEYSUM,
					SUM(SERVICETIP) SERVICETIPSUM,
					SUM(CHARGEMONEY)+SUM(SERVICETIP) EXPENSESUM,
					SUM(JQ) JQSUM,
					SUM(JF) JFSUM,
					SUM(FQ) FQSUM,
					SUM(FF) FFSUM,
					SUM(PQ) PQSUM,
					SUM(PF) PFSUM,
					SUM(GQ) GQSUM,
					SUM(GF) GFSUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )A
				LEFT JOIN(
				SELECT DATE_FORMAT(RECORDTIME,'%Y/%M/%D') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) APPEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE CHARGEMETHODID=0
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )B
				ON A.YMD = B.YMD
				LEFT JOIN(
				SELECT DATE_FORMAT(RECORDTIME,'%Y/%M/%D') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) CARDEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE CHARGEMETHODID=1
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD )C
				ON A.YMD = C.YMD
				LEFT JOIN(
				SELECT DATE_FORMAT(RECORDTIME,'%Y/%M/%D') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) WCEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						CHARGEMETHODID=3
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )D
				ON A.YMD =D.YMD
			ORDER BY A.YMD 
			)E
	</select>
	
	<!-- 按年查询数量 -->
	<select id="getCountByYear" parameterType="FindreportsDto" resultType="int">
			SELECT
				COUNT(*)
			FROM
				(SELECT 
					DATE_FORMAT(RECORDTIME,'%Y') YMD, 
					COUNT(*) COUNT,
					SUM(CHARGEQUANTITY) CHARGEQUANTITYSUM,
					SUM(CHARGEMONEY) CHARGEMONEYSUM,
					SUM(SERVICETIP) SERVICETIPSUM,
					SUM(CHARGEMONEY)+SUM(SERVICETIP) EXPENSESUM,
					SUM(JQ) JQSUM,
					SUM(JF) JFSUM,
					SUM(FQ) FQSUM,
					SUM(FF) FFSUM,
					SUM(PQ) PQSUM,
					SUM(PF) PFSUM,
					SUM(GQ) GQSUM,
					SUM(GF) GFSUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE   
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )A
				LEFT JOIN(
				SELECT  DATE_FORMAT(RECORDTIME,'%Y') YMD ,
						SUM(CHARGEMONEY)+SUM(SERVICETIP) APPEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						CHARGEMETHODID=0
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )B
				ON A.YMD = B.YMD
				LEFT JOIN(
				SELECT  DATE_FORMAT(RECORDTIME,'%Y') YMD ,
						SUM(CHARGEMONEY)+SUM(SERVICETIP) CARDEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						CHARGEMETHODID=1
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD )C
				ON A.YMD = C.YMD
				LEFT JOIN(
				SELECT  DATE_FORMAT(RECORDTIME,'%Y') YMD ,
						SUM(CHARGEMONEY)+SUM(SERVICETIP) WCEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE CHARGEMETHODID=3
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )D
				ON A.YMD =D.YMD
			ORDER BY A.YMD
	</select>
	
	
	<!-- 按月统计数量 -->
	<select id="getCountByMonth" parameterType="FindreportsDto" resultType="int">
			SELECT
					COUNT(*)
			FROM
				(SELECT 
					DATE_FORMAT(RECORDTIME,'%Y/%m') YMD ,
					COUNT(*) COUNT,
					SUM(CHARGEQUANTITY) CHARGEQUANTITYSUM,
					SUM(CHARGEMONEY) CHARGEMONEYSUM,
					SUM(SERVICETIP) SERVICETIPSUM,
					SUM(CHARGEMONEY)+SUM(SERVICETIP) EXPENSESUM,
					SUM(JQ) JQSUM,
					SUM(JF) JFSUM,
					SUM(FQ) FQSUM,
					SUM(FF) FFSUM,
					SUM(PQ) PQSUM,
					SUM(PF) PFSUM,
					SUM(GQ) GQSUM,
					SUM(GF) GFSUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE} 
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )A
				LEFT JOIN(
				SELECT DATE_FORMAT(RECORDTIME,'%Y/%m') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) APPEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						CHARGEMETHODID=0
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE} 
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )B
				ON A.YMD = B.YMD
				LEFT JOIN(
				SELECT DATE_FORMAT(RECORDTIME,'%Y/%m') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) CARDEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						CHARGEMETHODID=1
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE} 
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD )C
				ON A.YMD = C.YMD
				LEFT JOIN(
				SELECT DATE_FORMAT(RECORDTIME,'%Y/%m') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) WCEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						CHARGEMETHODID=3
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE} 
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )D
				ON A.YMD =D.YMD
		ORDER BY A.YMD
	</select>
	
	
	<!-- 按日统计查询记录 -->
	<select id="getCountByDay" parameterType="FindreportsDto" resultType="int">
		SELECT
				COUNT(*)
		FROM
			(SELECT 
				DATE_FORMAT(RECORDTIME,'%Y/%m/%d') YMD ,
				COUNT(*) COUNT,
				SUM(CHARGEQUANTITY) CHARGEQUANTITYSUM,
				SUM(CHARGEMONEY) CHARGEMONEYSUM,
				SUM(SERVICETIP) SERVICETIPSUM,
				SUM(CHARGEMONEY)+SUM(SERVICETIP) EXPENSESUM,
				SUM(JQ) JQSUM,
				SUM(JF) JFSUM,
				SUM(FQ) FQSUM,
				SUM(FF) FFSUM,
				SUM(PQ) PQSUM,
				SUM(PF) PFSUM,
				SUM(GQ) GQSUM,
				SUM(GF) GFSUM
			FROM USERCHARGERECORD UCR,CPINFO CP
			WHERE UCR.CPID = CP.CPID
			AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY YMD  )A
			LEFT JOIN(
			SELECT DATE_FORMAT(RECORDTIME,'%Y/%m/%d') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) APPEXPENSESUM
			FROM USERCHARGERECORD UCR,CPINFO CP
			WHERE 
					CHARGEMETHODID=0
			AND 
					UCR.CPID = CP.CPID
			AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY YMD  )B
			ON A.YMD = B.YMD
			LEFT JOIN(
			SELECT DATE_FORMAT(RECORDTIME,'%Y/%m/%d') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) CARDEXPENSESUM
			FROM USERCHARGERECORD UCR,CPINFO CP
			WHERE CHARGEMETHODID=1
			AND 
					UCR.CPID = CP.CPID
			AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY YMD )C
			ON A.YMD = C.YMD
			LEFT JOIN(
			SELECT DATE_FORMAT(RECORDTIME,'%Y/%m/%d') YMD ,
			SUM(CHARGEMONEY)+SUM(SERVICETIP) WCEXPENSESUM
			FROM USERCHARGERECORD UCR,CPINFO CP
			WHERE 
					CHARGEMETHODID=3
			AND 
					UCR.CPID = CP.CPID
			AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY YMD  )D
			ON A.YMD =D.YMD
		ORDER BY A.YMD
	</select>
	
	<!-- 查询用户统计 -->
	<select id="selectStatisticsByUser" parameterType="FindreportsDto" resultType="reportsDtoNew">
			SELECT 
				UCR.CARDNUM AS USERCARDID,
				CARD.CARDUSERNAME AS USERNAME,
				'无' AS USERID,
				COUNT(*) CHARGECOUNT,
				ROUND(SUM(CHARGEQUANTITY),2) CHARGEQUANTITY,
				ROUND(SUM(CHARGEMONEY),2)  CARDCHARGEMONEY,
				'0' AS APPCHARGEMONEY,
				'0' AS WCCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY)+SUM(SERVICETIP),2)  SUMCHARGEMONEY,
				ROUND(SUM(JQ),2)  JQ,
				ROUND(SUM(JF),2)  JF,
				ROUND(SUM(FQ),2)  FQ,
				ROUND(SUM(FF),2)  FF,
				ROUND(SUM(PQ),2)  PQ,
				ROUND(SUM(PF),2)  PF,
				ROUND(SUM(GQ),2)  GQ,
				ROUND(SUM(GF),2)  GF
			FROM USERCHARGERECORD UCR,CARDUSERINFO CARD,CPINFO CP
			WHERE 1=1
				AND UCR.CHARGEMETHODID=1
				AND UCR.CARDNUM = CARD.CARDNUM
				AND 
					UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY USERCARDID
			UNION ALL
			SELECT 
				'无' AS USERCARDID,
				APP.CPUSERNAME AS USERNAME,
				UCR.CPUSERID AS USERID,
				COUNT(*) AS CHARGECOUNT,
				ROUND(SUM(CHARGEQUANTITY),2) CHARGEQUANTITY,
				'0' AS CARDCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY),2)  APPCHARGEMONEY,
				'0' AS WCCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY)+SUM(SERVICETIP),2)  SUMCHARGEMONEY,
				ROUND(SUM(JQ),2)  JQ,
				ROUND(SUM(JF),2)  JF,
				ROUND(SUM(FQ),2)  FQ,
				ROUND(SUM(FF),2)  FF,
				ROUND(SUM(PQ),2)  PQ,
				ROUND(SUM(PF),2)  PF,
				ROUND(SUM(GQ),2)  GQ,
				ROUND(SUM(GF),2)  GF
			FROM USERCHARGERECORD UCR,CPUSERINFO APP,CPINFO CP
			WHERE 1=1
				AND UCR.CHARGEMETHODID=0
				AND UCR.CPUSERID = APP.CPUSERID
				AND 
					UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY USERID
			UNION ALL
			SELECT 
				'无'AS USERCARDID,
				'无'AS USERNAME,
				UCR.CPUSERID AS USERID,
				COUNT(*) AS CHARGECOUNT,
				ROUND(SUM(CHARGEQUANTITY),2) CHARGEQUANTITY,
				'0' AS CARDCHARGEMONEY,
				'0' AS APPCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY),2)  WCCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY)+SUM(SERVICETIP),2)  SUMCHARGEMONEY,
				ROUND(SUM(JQ),2)  JQ,
				ROUND(SUM(JF),2)  JF,
				ROUND(SUM(FQ),2)  FQ,
				ROUND(SUM(FF),2)  FF,
				ROUND(SUM(PQ),2)  PQ,
				ROUND(SUM(PF),2)  PF,
				ROUND(SUM(GQ),2)  GQ,
				ROUND(SUM(GF),2)  GF
			FROM USERCHARGERECORD UCR,WECHATUSERINFO WC,CPINFO CP
			WHERE 1=1
				AND UCR.CHARGEMETHODID=3
				AND UCR.CPUSERID = WC.USERID
				AND 
					UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY USERID
	</select>
	
	<!-- 用户统计数量 -->
	<select id="getCountByUser" parameterType="FindreportsDto" resultType="int">
		SELECT
			  ( 	(SELECT COUNT(*) 
				FROM(
					 SELECT COUNT(*) 
					 FROM USERCHARGERECORD UCR,CARDUSERINFO CARD,CPINFO CP
					 WHERE 1=1 
						AND UCR.CHARGEMETHODID=1 
						AND UCR.CARDNUM = CARD.CARDNUM 
						AND 
								UCR.CPID = CP.CPID
						AND     
								CP.OPERATORID IN (
								SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
								OR BOSSID = #{OPERATORLOGINID}
								OR BOSSID IN 
								(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
						)
						<if test="CSID!=null and CSID!=''">
						AND 
								CP.CSID = #{CSID}
						</if>
						<if test="FROMDATE!=null and FROMDATE!=''">
					    AND
								DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
						</if>
						<if test="TODATE!=null and TODATE!=''">
						AND
								DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
						</if>
					GROUP BY UCR.CARDNUM )A ) 
				+
				( SELECT COUNT(*) 
				FROM (
					SELECT COUNT(*) 
					FROM USERCHARGERECORD UCR,CPUSERINFO APP,CPINFO CP
					WHERE 1=1 
						AND UCR.CHARGEMETHODID=0 
						AND UCR.CPUSERID = APP.CPUSERID
						AND 
								UCR.CPID = CP.CPID
						AND     
								CP.OPERATORID IN (
								SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
								OR BOSSID = #{OPERATORLOGINID}
								OR BOSSID IN 
								(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
						)
						<if test="CSID!=null and CSID!=''">
						AND 
								CP.CSID = #{CSID}
						</if>
						<if test="FROMDATE!=null and FROMDATE!=''">
					    AND
								DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
						</if>
						<if test="TODATE!=null and TODATE!=''">
						AND
								DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
						</if>
					GROUP BY UCR.CPUSERID )B) 
				+( SELECT COUNT(*) 
				FROM (
					SELECT COUNT(*) 
					FROM USERCHARGERECORD UCR,WECHATUSERINFO WC,CPINFO CP
					WHERE 1=1 
						AND UCR.CHARGEMETHODID=3 
						AND UCR.CPUSERID = WC.USERID
						AND 
								UCR.CPID = CP.CPID
						AND     
								CP.OPERATORID IN (
								SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
								OR BOSSID = #{OPERATORLOGINID}
								OR BOSSID IN 
								(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
						)
						<if test="CSID!=null and CSID!=''">
						AND 
								CP.CSID = #{CSID}
						</if>
						<if test="FROMDATE!=null and FROMDATE!=''">
					    AND
								DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
						</if>
						<if test="TODATE!=null and TODATE!=''">
						AND
								DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
						</if>
					GROUP BY UCR.CPUSERID)C)
			  )  D
			FROM DUAL
	</select>
	
	<!-- 用户合计 -->
	<select id="selectUserTotal" parameterType="FindreportsDto" resultType="TotalDto">
		SELECT  SUM(CHARGECOUNT) TOTALCOUNT,
				SUM(CHARGEQUANTITY) TOTALQUANTITY,
				SUM(CARDCHARGEMONEY) TOTALCARDCHARGEMONEY,
				SUM(APPCHARGEMONEY) TOTALAPPCHARGEMONEY,
				SUM(WCCHARGEMONEY) TOTALWCCHARGEMONEY,
				SUM(SUMCHARGEMONEY) TOTALSUMCHARGEMONEY,
				SUM(JQ) TOTALJQ,
				SUM(JF) TOTALJF,
				SUM(FQ) TOTALFQ,
				SUM(FF) TOTALFF,
				SUM(PQ) TOTALPQ,
				SUM(PF) TOTALPF,
				SUM(GQ) TOTALGQ,
				SUM(GF) TOTALGF
		FROM (
				SELECT 
				UCR.CARDNUM AS USERCARDID,
				CARD.CARDUSERNAME AS USERNAME,
				'无' AS USERID,
				COUNT(*) CHARGECOUNT,
				ROUND(SUM(CHARGEQUANTITY),2) CHARGEQUANTITY,
				ROUND(SUM(CHARGEMONEY),2)  CARDCHARGEMONEY,
				'0' AS APPCHARGEMONEY,
				'0' AS WCCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY)+SUM(SERVICETIP),2)  SUMCHARGEMONEY,
				ROUND(SUM(JQ),2)  JQ,
				ROUND(SUM(JF),2)  JF,
				ROUND(SUM(FQ),2)  FQ,
				ROUND(SUM(FF),2)  FF,
				ROUND(SUM(PQ),2)  PQ,
				ROUND(SUM(PF),2)  PF,
				ROUND(SUM(GQ),2)  GQ,
				ROUND(SUM(GF),2)  GF
			FROM USERCHARGERECORD UCR,CARDUSERINFO CARD ,CPINFO CP
			WHERE 1=1
				AND UCR.CHARGEMETHODID=1
				AND UCR.CARDNUM = CARD.CARDNUM
				AND 
					UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY USERCARDID
			UNION ALL
			SELECT 
				'无' AS USERCARDID,
				APP.CPUSERNAME AS USERNAME,
				UCR.CPUSERID AS USERID,
				COUNT(*) AS CHARGECOUNT,
				ROUND(SUM(CHARGEQUANTITY),2) CHARGEQUANTITY,
				'0' AS CARDCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY),2)  APPCHARGEMONEY,
				'0' AS WCCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY)+SUM(SERVICETIP),2)  SUMCHARGEMONEY,
				ROUND(SUM(JQ),2)  JQ,
				ROUND(SUM(JF),2)  JF,
				ROUND(SUM(FQ),2)  FQ,
				ROUND(SUM(FF),2)  FF,
				ROUND(SUM(PQ),2)  PQ,
				ROUND(SUM(PF),2)  PF,
				ROUND(SUM(GQ),2)  GQ,
				ROUND(SUM(GF),2)  GF
			FROM USERCHARGERECORD UCR,CPUSERINFO APP ,CPINFO CP
			WHERE 1=1
				AND UCR.CHARGEMETHODID=0
				AND UCR.CPUSERID = APP.CPUSERID
				AND 
					UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY USERID
			UNION ALL
			SELECT 
				'无'AS USERCARDID,
				'无'AS USERNAME,
				UCR.CPUSERID AS USERID,
				COUNT(*) AS CHARGECOUNT,
				ROUND(SUM(CHARGEQUANTITY),2) CHARGEQUANTITY,
				'0' AS CARDCHARGEMONEY,
				'0' AS APPCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY),2)  WCCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY)+SUM(SERVICETIP),2)  SUMCHARGEMONEY,
				ROUND(SUM(JQ),2)  JQ,
				ROUND(SUM(JF),2)  JF,
				ROUND(SUM(FQ),2)  FQ,
				ROUND(SUM(FF),2)  FF,
				ROUND(SUM(PQ),2)  PQ,
				ROUND(SUM(PF),2)  PF,
				ROUND(SUM(GQ),2)  GQ,
				ROUND(SUM(GF),2)  GF
			FROM USERCHARGERECORD UCR,WECHATUSERINFO WC ,CPINFO CP
			WHERE 1=1
				AND UCR.CHARGEMETHODID=3
				AND UCR.CPUSERID = WC.USERID
				AND 
					UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY USERID
		)A
			
	</select>
	
	<!--获取查询条件上的充电站id、名 -->
	<select id="selectcslist" parameterType="FindreportsDto" resultType="reportsDtoNew">
		SELECT CSID ,CSNAME 
		FROM CSINFO 
		WHERE 1=1 
		AND 
			OPERATORID IN (
					SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
					OR BOSSID = #{OPERATORLOGINID}
					OR BOSSID IN 
					(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
	</select>
	
	<!-- 按日导出 -->
	<select id="findDayReportsList" parameterType="FindreportsDto" resultType="reportsDtoNew">
		SELECT
				A.YMD STATISTICSTIME,
				IFNULL(A.COUNT,0) CHARGECOUNT,
				ROUND(IFNULL(A.CHARGEQUANTITYSUM,0),2) CHARGEQUANTITY,
				ROUND(IFNULL(A.CHARGEMONEYSUM,0),2) CHARGEMONEY,
				ROUND(IFNULL(B.APPEXPENSESUM,0),2) APPCHARGEMONEY,
			    ROUND(IFNULL(C.CARDEXPENSESUM,0),2) CARDCHARGEMONEY,
				ROUND(IFNULL(D.WCEXPENSESUM,0),2)WCCHARGEMONEY,
				ROUND(IFNULL(A.SERVICETIPSUM,0),2) SERVICETIP,
				ROUND(IFNULL(A.EXPENSESUM,0),2) SUMCHARGEMONEY,
				ROUND(IFNULL(A.JQSUM,0),2) JQ,
				ROUND(IFNULL(A.JFSUM,0),2) JF,
				ROUND(IFNULL(A.FQSUM,0),2) FQ,
				ROUND(IFNULL(A.FFSUM,0),2) FF,
				ROUND(IFNULL(A.PQSUM,0),2) PQ,
				ROUND(IFNULL(A.PFSUM,0),2) PF,
				ROUND(IFNULL(A.GQSUM,0),2) GQ,
				ROUND(IFNULL(A.GFSUM,0),2) GF
		FROM
			(SELECT 
				DATE_FORMAT(RECORDTIME,'%Y/%m/%d') YMD ,
				COUNT(*) COUNT,
				SUM(CHARGEQUANTITY) CHARGEQUANTITYSUM,
				SUM(CHARGEMONEY) CHARGEMONEYSUM,
				SUM(SERVICETIP) SERVICETIPSUM,
				SUM(CHARGEMONEY)+SUM(SERVICETIP) EXPENSESUM,
				SUM(JQ) JQSUM,
				SUM(JF) JFSUM,
				SUM(FQ) FQSUM,
				SUM(FF) FFSUM,
				SUM(PQ) PQSUM,
				SUM(PF) PFSUM,
				SUM(GQ) GQSUM,
				SUM(GF) GFSUM
			FROM USERCHARGERECORD UCR,CPINFO CP
			WHERE UCR.CPID = CP.CPID
			AND     
					CP.OPERATORID IN (
					SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
					OR BOSSID = #{OPERATORLOGINID}
					OR BOSSID IN 
					(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
			)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY YMD  )A
			LEFT JOIN(
			SELECT DATE_FORMAT(RECORDTIME,'%Y/%m/%d') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) APPEXPENSESUM
			FROM USERCHARGERECORD UCR,CPINFO CP
			WHERE 
					CHARGEMETHODID=0
			AND 
					UCR.CPID = CP.CPID
			AND     
					CP.OPERATORID IN (
					SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
					OR BOSSID = #{OPERATORLOGINID}
					OR BOSSID IN 
					(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
			)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY YMD  )B
			ON A.YMD = B.YMD
			LEFT JOIN(
			SELECT DATE_FORMAT(RECORDTIME,'%Y/%m/%d') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) CARDEXPENSESUM
			FROM USERCHARGERECORD UCR,CPINFO CP
			WHERE CHARGEMETHODID=1
			AND 
					UCR.CPID = CP.CPID
			AND     
					CP.OPERATORID IN (
					SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
					OR BOSSID = #{OPERATORLOGINID}
					OR BOSSID IN 
					(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
			)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY YMD )C
			ON A.YMD = C.YMD
			LEFT JOIN(
			SELECT DATE_FORMAT(RECORDTIME,'%Y/%m/%d') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) WCEXPENSESUM
			FROM USERCHARGERECORD UCR,CPINFO CP
			WHERE 
					CHARGEMETHODID=3
			AND 
					UCR.CPID = CP.CPID
			AND     
					CP.OPERATORID IN (
					SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
					OR BOSSID = #{OPERATORLOGINID}
					OR BOSSID IN 
					(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
			)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY YMD  )D
			ON A.YMD =D.YMD
		ORDER BY A.YMD DESC
	</select>
	
	<!-- 按月导出 -->
	<select id="findMonthReportsList" parameterType="FindreportsDto" resultType="reportsDtoNew">
		SELECT
					A.YMD STATISTICSTIME,
					IFNULL(A.COUNT,0) CHARGECOUNT,
					ROUND(IFNULL(A.chargequantitySUM,0),2) CHARGEQUANTITY,
					ROUND(IFNULL(A.chargemoneySUM,0),2) CHARGEMONEY,
					ROUND(IFNULL(B.APPexpenseSUM,0),2) APPCHARGEMONEY,
				    ROUND(IFNULL(C.CARDexpenseSUM,0),2) CARDCHARGEMONEY,
					ROUND(IFNULL(D.WCexpenseSUM,0),2)WCCHARGEMONEY,
					ROUND(IFNULL(A.servicetipSUM,0),2) SERVICETIP,
					ROUND(IFNULL(A.expenseSUM,0),2) SUMCHARGEMONEY,
					ROUND(IFNULL(A.JQSUM,0),2) JQ,
					ROUND(IFNULL(A.JFSUM,0),2) JF,
					ROUND(IFNULL(A.FQSUM,0),2) FQ,
					ROUND(IFNULL(A.FFSUM,0),2) FF,
					ROUND(IFNULL(A.PQSUM,0),2) PQ,
					ROUND(IFNULL(A.PFSUM,0),2) PF,
					ROUND(IFNULL(A.GQSUM,0),2) GQ,
					ROUND(IFNULL(A.GFSUM,0),2) GF
			FROM
				(SELECT 
					DATE_FORMAT(RECORDTIME,'%Y/%m') YMD ,
					COUNT(*) COUNT,
					SUM(CHARGEQUANTITY) CHARGEQUANTITYSUM,
					SUM(CHARGEMONEY) CHARGEMONEYSUM,
					SUM(SERVICETIP) SERVICETIPSUM,
					SUM(CHARGEMONEY)+SUM(SERVICETIP) EXPENSESUM,
					SUM(JQ) JQSUM,
					SUM(JF) JFSUM,
					SUM(FQ) FQSUM,
					SUM(FF) FFSUM,
					SUM(PQ) PQSUM,
					SUM(PF) PFSUM,
					SUM(GQ) GQSUM,
					SUM(GF) GFSUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE} 
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{MONTHTODATE}
				</if>
				GROUP BY YMD  )A
				LEFT JOIN(
				SELECT DATE_FORMAT(RECORDTIME,'%Y/%m') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) APPEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						CHARGEMETHODID=0
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE} 
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{MONTHTODATE}
				</if>
				GROUP BY YMD  )B
				ON A.YMD = B.YMD
				LEFT JOIN(
				SELECT DATE_FORMAT(RECORDTIME,'%Y/%m') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) CARDEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						CHARGEMETHODID=1
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE} 
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD )C
				ON A.YMD = C.YMD
				LEFT JOIN(
				SELECT DATE_FORMAT(RECORDTIME,'%Y/%m') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) WCEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						CHARGEMETHODID=3
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE} 
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )D
				ON A.YMD =D.YMD
		ORDER BY A.YMD DESC
	</select>
	
	<!-- 按年导出 -->
	<select id="findYearReportsList" parameterType="FindreportsDto" resultType="reportsDtoNew">
		SELECT
				A.YMD STATISTICSTIME,
				IFNULL(A.COUNT,0) CHARGECOUNT,
				ROUND(IFNULL(A.chargequantitySUM,0),2) CHARGEQUANTITY,
				ROUND(IFNULL(A.chargemoneySUM,0),2) CHARGEMONEY,
				ROUND(IFNULL(B.APPexpenseSUM,0),2) APPCHARGEMONEY,
			    ROUND(IFNULL(C.CARDexpenseSUM,0),2) CARDCHARGEMONEY,
				ROUND(IFNULL(D.WCexpenseSUM,0),2)WCCHARGEMONEY,
				ROUND(IFNULL(A.servicetipSUM,0),2) SERVICETIP,
				ROUND(IFNULL(A.expenseSUM,0),2) SUMCHARGEMONEY,
				ROUND(IFNULL(A.JQSUM,0),2) JQ,
				ROUND(IFNULL(A.JFSUM,0),2) JF,
				ROUND(IFNULL(A.FQSUM,0),2) FQ,
				ROUND(IFNULL(A.FFSUM,0),2) FF,
				ROUND(IFNULL(A.PQSUM,0),2) PQ,
				ROUND(IFNULL(A.PFSUM,0),2) PF,
				ROUND(IFNULL(A.GQSUM,0),2) GQ,
				ROUND(IFNULL(A.GFSUM,0),2) GF
			FROM
				(SELECT 
					DATE_FORMAT(RECORDTIME,'%Y') YMD,
					COUNT(*) COUNT,
					SUM(CHARGEQUANTITY) CHARGEQUANTITYSUM,
					SUM(CHARGEMONEY) CHARGEMONEYSUM,
					SUM(SERVICETIP) SERVICETIPSUM,
					SUM(CHARGEMONEY)+SUM(SERVICETIP) EXPENSESUM,
					SUM(JQ) JQSUM,
					SUM(JF) JFSUM,
					SUM(FQ) FQSUM,
					SUM(FF) FFSUM,
					SUM(PQ) PQSUM,
					SUM(PF) PFSUM,
					SUM(GQ) GQSUM,
					SUM(GF) GFSUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE   
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )A
				LEFT JOIN(
				SELECT  DATE_FORMAT(RECORDTIME,'%Y') YMD ,
						SUM(CHARGEMONEY)+SUM(SERVICETIP) APPEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						CHARGEMETHODID=0
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )B
				ON A.YMD = B.YMD
				LEFT JOIN(
				SELECT  DATE_FORMAT(RECORDTIME,'%Y') YMD ,
						SUM(CHARGEMONEY)+SUM(SERVICETIP) CARDEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP 
				WHERE 
						CHARGEMETHODID=1
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD )C
				ON A.YMD = C.YMD
				LEFT JOIN(
				SELECT  DATE_FORMAT(RECORDTIME,'%Y') YMD ,
						SUM(CHARGEMONEY)+SUM(SERVICETIP) WCEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE CHARGEMETHODID=3
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )D
				ON A.YMD =D.YMD
			ORDER BY A.YMD DESC
	</select>
	
	<!-- 按用户导出 -->
	<select id="findUserReportsList" parameterType="FindreportsDto" resultType="reportsDtoNew">
		SELECT 
				UCR.CARDNUM AS USERCARDID,
				CARD.CARDUSERNAME AS USERNAME,
				'无' AS USERID,
				COUNT(*) CHARGECOUNT,
				ROUND(SUM(CHARGEQUANTITY),2) CHARGEQUANTITY,
				ROUND(SUM(CHARGEMONEY),2)  CARDCHARGEMONEY,
				'0' AS APPCHARGEMONEY,
				'0' AS WCCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY)+SUM(SERVICETIP),2)  SUMCHARGEMONEY,
				ROUND(SUM(JQ),2)  JQ,
				ROUND(SUM(JF),2)  JF,
				ROUND(SUM(FQ),2)  FQ,
				ROUND(SUM(FF),2)  FF,
				ROUND(SUM(PQ),2)  PQ,
				ROUND(SUM(PF),2)  PF,
				ROUND(SUM(GQ),2)  GQ,
				ROUND(SUM(GF),2)  GF
			FROM USERCHARGERECORD UCR,CARDUSERINFO CARD,CPINFO CP
			WHERE 1=1
				AND UCR.CHARGEMETHODID=1
				AND UCR.CARDNUM = CARD.CARDNUM
				AND 
					UCR.CPID = CP.CPID
				AND     
							CP.OPERATORID IN (
							SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
							OR BOSSID = #{OPERATORLOGINID}
							OR BOSSID IN 
							(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
					)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY USERCARDID
			UNION ALL
			SELECT 
				'无' AS USERCARDID,
				APP.CPUSERNAME AS USERNAME,
				UCR.CPUSERID AS USERID,
				COUNT(*) AS CHARGECOUNT,
				ROUND(SUM(CHARGEQUANTITY),2) CHARGEQUANTITY,
				'0' AS CARDCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY),2)  APPCHARGEMONEY,
				'0' AS WCCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY)+SUM(SERVICETIP),2)  SUMCHARGEMONEY,
				ROUND(SUM(JQ),2)  JQ,
				ROUND(SUM(JF),2)  JF,
				ROUND(SUM(FQ),2)  FQ,
				ROUND(SUM(FF),2)  FF,
				ROUND(SUM(PQ),2)  PQ,
				ROUND(SUM(PF),2)  PF,
				ROUND(SUM(GQ),2)  GQ,
				ROUND(SUM(GF),2)  GF
			FROM USERCHARGERECORD UCR,CPUSERINFO APP,CPINFO CP
			WHERE 1=1
				AND UCR.CHARGEMETHODID=0
				AND UCR.CPUSERID = APP.CPUSERID
				AND 
					UCR.CPID = CP.CPID
				AND     
							CP.OPERATORID IN (
							SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
							OR BOSSID = #{OPERATORLOGINID}
							OR BOSSID IN 
							(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
					)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY USERID
			UNION ALL
			SELECT 
				'无'AS USERCARDID,
				'无'AS USERNAME,
				UCR.CPUSERID AS USERID,
				COUNT(*) AS CHARGECOUNT,
				ROUND(SUM(CHARGEQUANTITY),2) CHARGEQUANTITY,
				'0' AS CARDCHARGEMONEY,
				'0' AS APPCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY),2)  WCCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY)+SUM(SERVICETIP),2)  SUMCHARGEMONEY,
				ROUND(SUM(JQ),2)  JQ,
				ROUND(SUM(JF),2)  JF,
				ROUND(SUM(FQ),2)  FQ,
				ROUND(SUM(FF),2)  FF,
				ROUND(SUM(PQ),2)  PQ,
				ROUND(SUM(PF),2)  PF,
				ROUND(SUM(GQ),2)  GQ,
				ROUND(SUM(GF),2)  GF
			FROM USERCHARGERECORD UCR,WECHATUSERINFO WC,CPINFO CP
			WHERE 1=1
				AND UCR.CHARGEMETHODID=3
				AND UCR.CPUSERID = WC.USERID
				AND 
					UCR.CPID = CP.CPID
				AND     
							CP.OPERATORID IN (
							SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
							OR BOSSID = #{OPERATORLOGINID}
							OR BOSSID IN 
							(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
					)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY USERID
	</select>
	
	<!-- 导出年月日合计 -->
	<select id="findReportsTotal" parameterType="FindreportsDto" resultType="TotalDto">
		SELECT  IFNULL(SUM(E.CHARGECOUNT),0) TOTALCOUNT,
				ROUND(IFNULL(SUM(E.CHARGEQUANTITY),0),2) TOTALQUANTITY,
				ROUND(IFNULL(SUM(E.CHARGEMONEY),0),2) TOTALCHARGEMONEY,
				ROUND(IFNULL(SUM(E.APPCHARGEMONEY),0),2) TOTALAPPCHARGEMONEY,
				ROUND(IFNULL(SUM(E.CARDCHARGEMONEY),0),2) TOTALCARDCHARGEMONEY,
				ROUND(IFNULL(SUM(E.WCCHARGEMONEY),0),2) TOTALWCCHARGEMONEY,
				ROUND(IFNULL(SUM(E.SERVICETIP),0),2) TOTALSERVICETIP,
				ROUND(IFNULL(SUM(E.SUMCHARGEMONEY),0),2) TOTALSUMCHARGEMONEY,
				ROUND(IFNULL(SUM(E.JQ),0),2) TOTALJQ,
				ROUND(IFNULL(SUM(E.JF),0),2) TOTALJF,
				ROUND(IFNULL(SUM(E.FQ),0),2) TOTALFQ,
				ROUND(IFNULL(SUM(E.FF),0),2) TOTALFF,
				ROUND(IFNULL(SUM(E.PQ),0),2) TOTALPQ,
			    ROUND(IFNULL(SUM(E.PF),0),2) TOTALPF,
				ROUND(IFNULL(SUM(E.GQ),0),2) TOTALGQ,
				ROUND(IFNULL(SUM(E.GF),0),2) TOTALGF
			FROM(
			SELECT
				A.YMD STATISTICSTIME,
				IFNULL(A.COUNT,0) CHARGECOUNT,
				IFNULL(A.CHARGEQUANTITYSUM,0) CHARGEQUANTITY,
				IFNULL(A.CHARGEMONEYSUM,0) CHARGEMONEY,
				IFNULL(B.APPEXPENSESUM ,0) APPCHARGEMONEY,
				IFNULL(C.CARDEXPENSESUM ,0) CARDCHARGEMONEY,
				IFNULL(D.WCEXPENSESUM ,0)WCCHARGEMONEY,
				IFNULL(A.SERVICETIPSUM,0) SERVICETIP,
				IFNULL(A.EXPENSESUM,0) SUMCHARGEMONEY,
				IFNULL(A.JQSUM,0) JQ,
				IFNULL(A.JFSUM,0) JF,
				IFNULL(A.FQSUM,0) FQ,
				IFNULL(A.FFSUM,0) FF,
				IFNULL(A.PQSUM,0) PQ,
				IFNULL(A.PFSUM,0) PF,
				IFNULL(A.GQSUM,0) GQ,
				IFNULL(A.GFSUM,0) GF
			FROM
				(SELECT 
					DATE_FORMAT(RECORDTIME,'%Y/%M/%D') YMD ,
					COUNT(*) COUNT,
					SUM(CHARGEQUANTITY) CHARGEQUANTITYSUM,
					SUM(CHARGEMONEY) CHARGEMONEYSUM,
					SUM(SERVICETIP) SERVICETIPSUM,
					SUM(CHARGEMONEY)+SUM(SERVICETIP) EXPENSESUM,
					SUM(JQ) JQSUM,
					SUM(JF) JFSUM,
					SUM(FQ) FQSUM,
					SUM(FF) FFSUM,
					SUM(PQ) PQSUM,
					SUM(PF) PFSUM,
					SUM(GQ) GQSUM,
					SUM(GF) GFSUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )A
				LEFT JOIN(
				SELECT DATE_FORMAT(RECORDTIME,'%Y/%M/%D') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) APPEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE CHARGEMETHODID=0
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )B
				ON A.YMD = B.YMD
				LEFT JOIN(
				SELECT DATE_FORMAT(RECORDTIME,'%Y/%M/%D') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) CARDEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE CHARGEMETHODID=1
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD )C
				ON A.YMD = C.YMD
				LEFT JOIN(
				SELECT DATE_FORMAT(RECORDTIME,'%Y/%M/%D') YMD ,SUM(CHARGEMONEY)+SUM(SERVICETIP) WCEXPENSESUM
				FROM USERCHARGERECORD UCR,CPINFO CP
				WHERE 
						CHARGEMETHODID=3
				AND 
						UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
				<if test="CSID!=null and CSID!=''">
				AND 
						CP.CSID = #{CSID}
				</if>
				<if test="FROMDATE!=null and FROMDATE!=''">
			    AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
				</if>
				<if test="TODATE!=null and TODATE!=''">
				AND
						DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
				</if>
				GROUP BY YMD  )D
				ON A.YMD =D.YMD
			ORDER BY A.YMD
			)E
	</select>

	<!-- 导出用户合计 -->
	<select id="findUserReportsTotal" parameterType="FindreportsDto" resultType="TotalDto">
		SELECT  SUM(CHARGECOUNT) TOTALCOUNT,
				SUM(CHARGEQUANTITY) TOTALQUANTITY,
				ROUND(SUM(CARDCHARGEMONEY),2) TOTALCARDCHARGEMONEY,
				ROUND(SUM(APPCHARGEMONEY),2) TOTALAPPCHARGEMONEY,
				ROUND(SUM(WCCHARGEMONEY),2) TOTALWCCHARGEMONEY,
				SUM(SUMCHARGEMONEY) TOTALSUMCHARGEMONEY,
				SUM(JQ) TOTALJQ,
				SUM(JF) TOTALJF,
				SUM(FQ) TOTALFQ,
				SUM(FF) TOTALFF,
				SUM(PQ) TOTALPQ,
				SUM(PF) TOTALPF,
				SUM(GQ) TOTALGQ,
				SUM(GF) TOTALGF
		FROM (
				SELECT 
				UCR.CARDNUM AS USERCARDID,
				CARD.CARDUSERNAME AS USERNAME,
				'无' AS USERID,
				COUNT(*) CHARGECOUNT,
				ROUND(SUM(CHARGEQUANTITY),2) CHARGEQUANTITY,
				ROUND(SUM(CHARGEMONEY),2)  CARDCHARGEMONEY,
				'0' AS APPCHARGEMONEY,
				'0' AS WCCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY)+SUM(SERVICETIP),2)  SUMCHARGEMONEY,
				ROUND(SUM(JQ),2)  JQ,
				ROUND(SUM(JF),2)  JF,
				ROUND(SUM(FQ),2)  FQ,
				ROUND(SUM(FF),2)  FF,
				ROUND(SUM(PQ),2)  PQ,
				ROUND(SUM(PF),2)  PF,
				ROUND(SUM(GQ),2)  GQ,
				ROUND(SUM(GF),2)  GF
			FROM USERCHARGERECORD UCR,CARDUSERINFO CARD ,CPINFO CP
			WHERE 1=1
				AND UCR.CHARGEMETHODID=1
				AND UCR.CARDNUM = CARD.CARDNUM
				AND 
					UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY USERCARDID
			UNION ALL
			SELECT 
				'无' AS USERCARDID,
				APP.CPUSERNAME AS USERNAME,
				UCR.CPUSERID AS USERID,
				COUNT(*) AS CHARGECOUNT,
				ROUND(SUM(CHARGEQUANTITY),2) CHARGEQUANTITY,
				'0' AS CARDCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY),2)  APPCHARGEMONEY,
				'0' AS WCCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY)+SUM(SERVICETIP),2)  SUMCHARGEMONEY,
				ROUND(SUM(JQ),2)  JQ,
				ROUND(SUM(JF),2)  JF,
				ROUND(SUM(FQ),2)  FQ,
				ROUND(SUM(FF),2)  FF,
				ROUND(SUM(PQ),2)  PQ,
				ROUND(SUM(PF),2)  PF,
				ROUND(SUM(GQ),2)  GQ,
				ROUND(SUM(GF),2)  GF
			FROM USERCHARGERECORD UCR,CPUSERINFO APP ,CPINFO CP
			WHERE 1=1
				AND UCR.CHARGEMETHODID=0
				AND UCR.CPUSERID = APP.CPUSERID
				AND 
					UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY USERID
			UNION ALL
			SELECT 
				'无'AS USERCARDID,
				'无'AS USERNAME,
				UCR.CPUSERID AS USERID,
				COUNT(*) AS CHARGECOUNT,
				ROUND(SUM(CHARGEQUANTITY),2) CHARGEQUANTITY,
				'0' AS CARDCHARGEMONEY,
				'0' AS APPCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY),2)  WCCHARGEMONEY,
				ROUND(SUM(CHARGEMONEY)+SUM(SERVICETIP),2)  SUMCHARGEMONEY,
				ROUND(SUM(JQ),2)  JQ,
				ROUND(SUM(JF),2)  JF,
				ROUND(SUM(FQ),2)  FQ,
				ROUND(SUM(FF),2)  FF,
				ROUND(SUM(PQ),2)  PQ,
				ROUND(SUM(PF),2)  PF,
				ROUND(SUM(GQ),2)  GQ,
				ROUND(SUM(GF),2)  GF
			FROM USERCHARGERECORD UCR,WECHATUSERINFO WC ,CPINFO CP
			WHERE 1=1
				AND UCR.CHARGEMETHODID=3
				AND UCR.CPUSERID = WC.USERID
				AND 
					UCR.CPID = CP.CPID
				AND     
						CP.OPERATORID IN (
						SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
			<if test="CSID!=null and CSID!=''">
			AND 
					CP.CSID = #{CSID}
			</if>
			<if test="FROMDATE!=null and FROMDATE!=''">
		    AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &gt;= #{FROMDATE}
			</if>
			<if test="TODATE!=null and TODATE!=''">
			AND
					DATE_FORMAT(UCR.RECORDTIME, '%Y-%m-%d') &lt;= #{TODATE}
			</if>
			GROUP BY USERID
		)A
			
	</select>
	
	<!-- 找充电站 -->
	<select id="findcsList" parameterType="FindreportsDto" resultType="reportsDto">
		SELECT CSID,CSNAME
		FROM    CSINFO 
		WHERE 
				OPERATORID IN (
					SELECT OPERATORID FROM OPERATORINFO WHERE OPERATORID =#{OPERATORLOGINID}
						OR BOSSID = #{OPERATORLOGINID}
						OR BOSSID IN 
						(SELECT OPERATORID FROM OPERATORINFO WHERE BOSSID=#{OPERATORLOGINID})
				)
	</select>
</mapper>